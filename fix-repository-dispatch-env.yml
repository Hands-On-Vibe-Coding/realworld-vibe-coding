# 환경 변수를 사용한 repository-dispatch 예제
- name: Set commit message
  id: commit-msg
  run: |
    # 개행 문자를 공백으로 변환하고 JSON 이스케이프 처리
    COMMIT_MSG=$(echo '${{ github.event.head_commit.message }}' | tr '\n' ' ' | sed 's/"/\\"/g')
    echo "commit_message=$COMMIT_MSG" >> $GITHUB_OUTPUT

- name: Repository Dispatch
  uses: peter-evans/repository-dispatch@v2
  with:
    token: ${{ secrets.GITHUB_TOKEN }}
    event-type: dev-deploy-success
    repository: nextintelligence-ai/company-logo
    client-payload: |
      {
        "branch": "${{ github.ref_name }}",
        "commit_sha": "${{ github.sha }}",
        "commit_message": "${{ steps.commit-msg.outputs.commit_message }}",
        "actor": "${{ github.actor }}",
        "pr_number": "${{ github.event.pull_request.number || '' }}",
        "dev_run_id": "${{ github.run_id }}",
        "dev_run_url": "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
      }